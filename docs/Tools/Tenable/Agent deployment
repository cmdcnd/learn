
## Updated 17 April 2025
#### Tennable.IO Scanning via SCCM or ManageEngine. (Anything an agency uses to push out software or powershell commands)

1.  Navigate to https://www.tenable.com/downloads/nessus-agents?loginAttempted=true and download the
    appropriate agent for the entity's environment. (x64)

2.  After Downloading the Agent, provide the agent to the Entity's ISO
    or SCCM person. Have that individual push the agent out to all assets identified for scans via SCCM. No special scripting is required for this.

3.  Log into Lastpass and navigate to Tenable.IO(ISA)**

4.  Click on the ellipsis in the upper left hand corner and click settings

![](cmdcnd/learn/docs/images/tennableIo%20settings.PNG)

5.  Select Sensors

![](cmdcnd/learn/docs/images/TennableIO_Sensors.PNG)

6.  Select Nessus Agents on the left and then click Add Nessus Agent
![](cmdcnd/learn/docs/images/addagent.png)


7.  This is where you obtain the agent key. Copy this key, you will be using it in step 12.

![](cmdcnd/learn/docs/images/TennableIO_Agent_key.PNG)

8.  Create Agent group
![](cmdcnd/learn/docs/images/8SS.PNG)


9.  Add the Agency name for the group name.
![](cmdcnd/learn/docs/images/9SS.PNG)


10. Use the above key (In step \#7) in the following powershell script.
    (note: this key will change)

11. Enter the agency name after --groups

12. The name has to match exactly as you named it in step\#9

```
"C:\Program Files\Tenable\Nessus Agent\nessuscli.exe" agent link --key=038c66bb9a0b738a9a0dd5537598b4ac034954cd1f0865e0a73119032c680952 --host="cloud.tenable.com" --port="443" --groups "{Agency_Name}"
reg add HKEY_LOCAL_MACHINE\SOFTWARE\NESSUS /v ScriptRan /t REG_SZ /d true /f
exit

OR (use bottom if entity downloaded agent 10.3.0 or newer)

C:\"Program Files"\Tenable\Nessus\nessuscli.exe agent link --key=038c66bb9a0b738a9a0dd5537598b4ac034954cd1f0865e0a73119032c680952 --host="cloud.tenable.com" --port="443" --groups "{Agency_Name}"
reg add HKEY_LOCAL_MACHINE\SOFTWARE\NESSUS /v ScriptRan /t REG_SZ /d true /f
exit
```

13. Once the script is filled out with the key and group name send
    that powershell script to the SCCM individual. They must run the
    powershell script in ADMIN context.

14. After the powershell command has been pushed to the cloud managed
    assets you should be able to run the following powershell command
    locally on any box to verify status.
    ```
    .\\nessuscli.exe agent status
    ```
![](cmdcnd/learn/docs/images/verify.png)

15. Verify that the number of Linked agents is close to the expected
    asset count.

![](cmdcnd/learn/docs/images/15Screenshot.png)

16. Once you have reached the expected asset count, select all of the checked in hosts and assign to Agency agent group that was created in Step 8.

17. Create a scan for the group. Navigate to the ellipsis > Scans

![](cmdcnd/learn/docs/images/Nessus_create_scan.png)

18. Click on "create scan"
![](cmdcnd/learn/docs/images/CreateNewScan.png)

19. Select User Defined and click on TEMPLATE_RA_AgentScans
![](cmdcnd/learn/docs/images/tenableUserDefinedScan.png)

20. Name your scan the name of the agency and FY.(agency_22-23)
 Select your agent group from the drop down and set your duration of the scan to 1 day.

21. Save and launch the scan. Scan will be complete at the end of the scan duration.

22. When the scan is complete export to .Nessus file.
![](cmdcnd/learn/docs/images/exportnessus.png)

23. Upload results to Nessus and create repository

24. Creating an Agent based repository, navigate to Tenable ISA
    (Repository Admin) and click Repositories and then click add

![](cmdcnd/learn/docs/images/17ss.PNG)

25. Choose Agent
![](cmdcnd/learn/docs/images/18SS.PNG)


26. Enter agency name and turn off Generate Trend Data and press
    submit

![](cmdcnd/learn/docs/images/19SS.PNG)

27. Open lastpass and navigate to Tenable ISA (Analyst site)

28. Upload .Nessus file to Scans > Scan Results
![](cmdcnd/learn/docs/images/uploadscans.png)

29. Upload results by clicking "Upload Scan Results", select your .nessus file and upload to the agency repository that was created in step 23.
![](cmdcnd/learn/docs/images/uploadresults.png)
![](cmdcnd/learn/docs/images/uploadsettings.png)

30. Congratulations, hopefully success. Run your reports normally.

